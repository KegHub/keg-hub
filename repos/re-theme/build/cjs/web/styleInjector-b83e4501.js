"use strict";var e=require("./useTheme-c66cd68a.js"),t=require("react"),r=require("@keg-hub/jsutils"),n=require("react-native-web/dist/modules/prefixStyles"),o=require("react-native-web/dist/exports/StyleSheet/flattenStyle"),a=require("react-native-web/dist/exports/StyleSheet/createReactDOMStyle"),l=require("react-native-web/dist/exports/StyleSheet/createCompileableStyle");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s,c=_interopDefaultLegacy(t),i=_interopDefaultLegacy(n),u=_interopDefaultLegacy(o),f=_interopDefaultLegacy(a),d=_interopDefaultLegacy(l),p={important:[],filter:["aspectRatio","elevation","overlayColor","resizeMode","tintColor","backgroundSize","animationKeyframes","placeholderTextColor","pointerEvents","scrollbarWidth"],allowedStyleObject:["transform","shadowOffset","textShadowOffset","animationKeyframes"]},y=r.hasDomAccess(),m=new Set,selectorExists=function(e){return m.has(e)},getKegSheet=function(){return s=s||document.head.querySelector("#".concat(e.Constants.KEG_STYLES_TAG_ID))},formatSelectors=function(e,t,n,o){var a=r.exists(o)?o:1,l=t.filter((function(e){return e&&n?e.startsWith(n):e})).reverse().slice(0,a).sort();return{selector:".".concat(l.concat([e]).join(".")).trim(),classNames:t.concat([e]).join(" ").trim()}},getSelector=function(e,t,n,o){var a="".concat(n,"-").concat(r.hashString(t)),l=r.isArr(e)?formatSelectors(a,e,n,o):r.isStr(e)?formatSelectors(a,e.split(" "),n,o):formatSelectors(a,r.noPropArr,n,o),s=l.selector;return{hashClass:a,classNames:l.classNames,selector:!selectorExists(s)&&s}},addStylesToDom=function(e,t){y&&t&&!selectorExists(e)&&(m.add(e),getKegSheet().sheet.insertRule("@media all {".concat(t.all,"}")))};e.addThemeEvent(e.Constants.BUILD_EVENT,(function(){m.clear(),getKegSheet().textContent=""})),function(){if(y){if(s=document.head.querySelector("#".concat(e.Constants.KEG_STYLES_TAG_ID)))return s;(s=document.createElement("style")).id=e.Constants.KEG_STYLES_TAG_ID,document.head.append(s)}}();var createBlock=function(e,t){var n=p.important.concat(null==t?void 0:t.important),o=i.default(f.default(e)),a=Object.keys(o).map((function(e){var t=function(e,t,r){return r.includes(e)?"".concat(t," !important"):t}(e,o[e],n),a=r.hyphenator(e);return r.isArr(t)?t.map((function(e){return"".concat(a,":").concat(e)})).join(";"):"".concat(a,":").concat(t)})).sort().join(";");return"{".concat(a,"}")},convertToCss=function(t,n){return r.flatArr(r.eitherArr(t,[t])).reduce((function(t,o){if(!r.isObj(o))return t;var a=function(t,n){var o=r.isArr(n)?p.filter.concat(n):p.filter;if(Boolean(Object.entries(t).filter((function(t){var n=e._slicedToArray(t,2),o=n[0],a=n[1];return r.isObj(a)&&!p.allowedStyleObject.includes(o)})).length))return{filtered:t};var a=r.splitByKeys(t,o),l=e._slicedToArray(a,2),s=l[0];return{style:l[1],filtered:s}}(o,null==n?void 0:n.filter),l=a.style,s=a.filtered;if(Object.assign(t.filtered,s),!l)return t;var c=u.default(l),i=d.default(c);return t.blocks.push(createBlock(i,n)),t}),{blocks:[],filtered:{}})},useStyleTag=function(n){var o,a,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0;s=r.isObj(s)?s:r.noOpObj;var c=e.useTheme(),i=null==c||null===(o=c.RTMeta)||void 0===o?void 0:o.size,u=null==c||null===(a=c.RTMeta)||void 0===a?void 0:a.key;return t.useMemo((function(){var e=convertToCss(n,s),t=e.blocks,r=e.filtered,o=getSelector(l,t.join(""),s.prefix||"keg",s.maxSelectors),a=o.selector,c=o.classNames,i=t.reduce((function(e,t){var r="".concat(a).concat(t);return e.all+=r,e.rules.push(r),e}),{all:"",rules:[]});return addStylesToDom(a,i),{css:i,classNames:c,filteredStyle:r}}),[n,l,i,u,s])},S=["config","children","Component","className","styleProp","splitStyles"],v=r.noOpObj,buildConfig=function(t){var r=t.kegComponent?t.maxSelectors:v.maxSelectors;return e._objectSpread2(e._objectSpread2(e._objectSpread2({},t),v),{},{maxSelectors:r||0})},_=c.default.forwardRef((function(t,r){var n=t.config,o=t.children,a=t.Component,l=t.className,s=t.styleProp,i=t.splitStyles,u=e._objectWithoutProperties(t,S),f=n.className,d=e.useCompiledStyles(i),p=useStyleTag(d,l||f,n),y=p.classNames,m=p.filteredStyle;return c.default.createElement(a,e._extends({},u,e._defineProperty({},s,m),{ref:r,className:y}),o)})),StyleInjector=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.noOpObj;return n=buildConfig(n),c.default.forwardRef((function(o,a){var l=o.__reStyleStylePropKey__||"style",s=r.splitByKeys(o,[l,"__reStyleStylePropKey__"]),i=e._slicedToArray(s,2),u=i[0],f=i[1],d=u[l];return d&&d!==r.noOpObj?c.default.createElement(_,e._extends({},f,{ref:a,config:n,Component:t,splitStyles:d,styleProp:l})):c.default.createElement(t,e._extends({},f,e._defineProperty({},l,d),{ref:a}))}))};StyleInjector.setConfig=function(e){r.isObj(e)||console.warn('Injector config must be an "Object". Instead got',e),v=e},exports.StyleInjector=StyleInjector,exports.convertToCss=convertToCss,exports.createBlock=createBlock,exports.useStyleTag=useStyleTag;
//# sourceMappingURL=styleInjector-b83e4501.js.map
