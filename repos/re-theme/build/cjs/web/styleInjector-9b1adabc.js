"use strict";var e=require("./useTheme-c66cd68a.js"),t=require("react"),r=require("@keg-hub/jsutils"),n=require("react-native-web/dist/modules/prefixStyles"),o=require("react-native-web/dist/exports/StyleSheet/createReactDOMStyle"),a=require("react-native-web/dist/exports/StyleSheet/createCompileableStyle");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l,s=_interopDefaultLegacy(t),i=_interopDefaultLegacy(n),c=_interopDefaultLegacy(o),u=_interopDefaultLegacy(a),loopArrStyle=function(e,t){for(var r=0,n=e.length;r<n;++r){var o=flattenStyle(e[r]);if(o)for(var a in o){var l=o[a];t[a]=l}}return t},flattenStyle=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&!0!==e?Array.isArray(e)?loopArrStyle(e,t):e:void 0},f={important:[],filter:["aspectRatio","elevation","overlayColor","resizeMode","tintColor","backgroundSize","animationKeyframes","placeholderTextColor","pointerEvents","scrollbarWidth"],allowedStyleObject:["transform","shadowOffset","textShadowOffset","animationKeyframes"]},d=r.hasDomAccess(),p=new Set,selectorExists=function(e){return p.has(e)},getKegSheet=function(){return l=l||document.head.querySelector("#".concat(e.Constants.KEG_STYLES_TAG_ID))},formatSelectors=function(t,n,o,a){var l=r.exists(a)?a:1,s=n.filter((function(e){return e&&o?e.startsWith(o):e})).reverse().slice(0,l).sort().reduce((function(t,r){return r&&t.push.apply(t,e._toConsumableArray(r.split(" "))),t}),[]);return{selector:".".concat(s.concat([t]).join(".")).trim(),classNames:n.concat([t]).join(" ").trim()}},getSelector=function(e,t,n,o){var a="".concat(n,"-").concat(r.hashString(t)),l=r.isArr(e)?formatSelectors(a,e,n,o):r.isStr(e)?formatSelectors(a,e.split(" "),n,o):formatSelectors(a,r.noPropArr,n,o),s=l.selector;return{hashClass:a,classNames:l.classNames,selector:!selectorExists(s)&&s}},addStylesToDom=function(e,t){if(d&&t&&t.all&&!selectorExists(e))try{p.add(e),getKegSheet().sheet.insertRule(t.all)}catch(e){console.error(e)}};e.addThemeEvent(e.Constants.BUILD_EVENT,(function(){p.clear(),getKegSheet().textContent=""})),function(){if(d){if(l=document.head.querySelector("#".concat(e.Constants.KEG_STYLES_TAG_ID)))return l;(l=document.createElement("style")).id=e.Constants.KEG_STYLES_TAG_ID,document.head.append(l)}}();var createBlock=function(e,t){var n=f.important.concat(null==t?void 0:t.important),o=i.default(c.default(e)),a=Object.keys(o).map((function(e){var t=function(e,t,r){return r.includes(e)?"".concat(t," !important"):t}(e,o[e],n),a=r.hyphenator(e);return r.isArr(t)?t.map((function(e){return"".concat(a,":").concat(e)})).join(";"):"".concat(a,":").concat(t)})).sort().join(";");return a.length?"{".concat(a,";}"):"{}"},convertToCss=function(t,n){var o=r.deepMerge.apply(void 0,e._toConsumableArray(r.flatArr(r.eitherArr(t,[t])))),a={blocks:[],filtered:{}};if(!r.isObj(o))return a;var l=function(t,n){var o=r.isArr(n)?f.filter.concat(n):f.filter,a={},l=!1,s=Object.entries(t).reduce((function(t,n){var o=e._slicedToArray(n,2),s=o[0],i=o[1];return!r.isObj(i)&&!r.isArr(i)||f.allowedStyleObject.includes(s)?a[s]=i:(l=!0,t[s]=i),t}),{});if(l)return{style:a,filtered:s};var i=r.splitByKeys(t,o),c=e._slicedToArray(i,2),u=c[0];return{style:c[1],filtered:u}}(o,null==n?void 0:n.filter),s=l.style,i=l.filtered;if(a.filtered=i,!s||r.isEmptyColl(s))return a;var c=flattenStyle(s),d=u.default(c);return a.blocks.push(createBlock(d,n)),a},useStyleTag=function(n){var o,a,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0;s=r.isObj(s)?s:r.noOpObj;var i=e.useTheme(),c=null==i||null===(o=i.RTMeta)||void 0===o?void 0:o.size,u=null==i||null===(a=i.RTMeta)||void 0===a?void 0:a.key;return t.useMemo((function(){var e={all:"",rules:[]},t=convertToCss(n,s),o=t.blocks,a=t.filtered;if(!o.length)return{css:e,filteredStyle:a,classNames:r.eitherArr(l,[l]).join(" ")};var i=getSelector(l,o.join(""),s.prefix||"keg",s.maxSelectors),c=i.selector,u=i.classNames;return c&&o.map((function(t){var r="".concat(c).concat(t);e.all+=r,e.rules.push(r)})),e.all&&addStylesToDom(c,e),{css:e,classNames:u,filteredStyle:a}}),[n,l,c,u,s])},y=["config","children","Component","className","styleProp","splitStyles"],m=r.noOpObj,buildConfig=function(t){var r=t.kegComponent?t.maxSelectors:m.maxSelectors;return e._objectSpread2(e._objectSpread2(e._objectSpread2({},t),m),{},{maxSelectors:r||0})},v=s.default.forwardRef((function(t,r){var n=t.config,o=t.children,a=t.Component,l=t.className,i=t.styleProp,c=t.splitStyles,u=e._objectWithoutProperties(t,y),f=n.className,d=e.useCompiledStyles(c),p=useStyleTag(d,l||f,n),m=p.classNames,v=p.filteredStyle;return s.default.createElement(a,e._extends({},u,e._defineProperty({},i,v),{ref:r,className:m}),o)})),StyleInjector=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.noOpObj;return n=buildConfig(n),s.default.forwardRef((function(o,a){var l=o.__reStyleStylePropKey__||"style",i=r.splitByKeys(o,[l,"__reStyleStylePropKey__"]),c=e._slicedToArray(i,2),u=c[0],f=c[1],d=u[l];return d&&d!==r.noOpObj?s.default.createElement(v,e._extends({},f,{ref:a,config:n,Component:t,splitStyles:d,styleProp:l})):s.default.createElement(t,e._extends({},f,e._defineProperty({},l,d),{ref:a}))}))};StyleInjector.setConfig=function(e){r.isObj(e)||console.warn('Injector config must be an "Object". Instead got',e),m=e},exports.StyleInjector=StyleInjector,exports.convertToCss=convertToCss,exports.createBlock=createBlock,exports.useStyleTag=useStyleTag;
//# sourceMappingURL=styleInjector-9b1adabc.js.map
