import{deepFreeze as e,hasDomAccess as r,checkCall as t,debounce as n,isArr as o,isFunc as i,isObj as a,deepMerge as f,get as d,isNum as u,logData as l,mapObj as c,softFalsy as s,toNum as p,isStr as y,noPropArr as h}from"@keg-hub/jsutils";import b,{useState as _,useEffect as m,useMemo as g,useContext as v}from"react";var P,w=e({BUILD_EVENT:"build",CHANGE_EVENT:"change",RESIZE_EVENT:"resize",ADD_EVENT:"addEventListener",REMOVE_EVENT:"removeEventListener",KEG_STYLES_TAG_ID:"keg-components-stylesheet",PLATFORM:{NATIVE:"$native",IOS:"$ios",android:"$android",WEB:"$web",ALL:"$all"}});function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _objectSpread2(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _extends(){return(_extends=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function _objectWithoutProperties(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function _slicedToArray(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==t)return;var n,o,i=[],a=!0,f=!1;try{for(t=t.call(e);!(a=(n=t.next()).done)&&(i.push(n.value),!r||i.length!==r);a=!0);}catch(e){f=!0,o=e}finally{try{a||null==t.return||t.return()}finally{if(f)throw o}}return i}(e,r)||_unsupportedIterableToArray(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(e){return function(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_unsupportedIterableToArray(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var S=(_defineProperty(P={m:"margin",mT:"marginTop",mB:"marginBottom",mR:"marginRight",mL:"marginLeft",mH:"marginHorizontal",mV:"marginVertical",p:"padding",pT:"paddingTop",pB:"paddingBottom",pR:"paddingRight",pL:"paddingLeft",pH:"paddingHorizontal",pV:"paddingVertical",bC:"borderColor",bW:"borderWidth",bS:"borderStyle"},"bC","borderColor"),_defineProperty(P,"bRad","borderRadius"),_defineProperty(P,"bTC","borderTopColor"),_defineProperty(P,"bTW","borderTopWidth"),_defineProperty(P,"bBC","borderBottomColor"),_defineProperty(P,"bBW","borderBottomWidth"),_defineProperty(P,"bRC","borderRightColor"),_defineProperty(P,"bRW","borderRightWidth"),_defineProperty(P,"bLC","borderLeftColor"),_defineProperty(P,"bLW","borderLeftWidth"),_defineProperty(P,"c","color"),_defineProperty(P,"bg","background"),_defineProperty(P,"bgC","backgroundColor"),_defineProperty(P,"d","display"),_defineProperty(P,"ovf","overflow"),_defineProperty(P,"ovfX","overflowX"),_defineProperty(P,"ovfY","overflowY"),_defineProperty(P,"pos","position"),_defineProperty(P,"z","zIndex"),_defineProperty(P,"tp","top"),_defineProperty(P,"bt","bottom"),_defineProperty(P,"btm","bottom"),_defineProperty(P,"lt","left"),_defineProperty(P,"rt","right"),_defineProperty(P,"bxS","boxShadow"),_defineProperty(P,"op","opacity"),_defineProperty(P,"ptrE","pointerEvents"),_defineProperty(P,"otl","outline"),_defineProperty(P,"fl","flex"),_defineProperty(P,"flD","flexDirection"),_defineProperty(P,"flWr","flexWrap"),_defineProperty(P,"flB","flexBasis"),_defineProperty(P,"flG","flexGrow"),_defineProperty(P,"flS","flexShrink"),_defineProperty(P,"jtC","justifyContent"),_defineProperty(P,"alC","alignContent"),_defineProperty(P,"alS","alignSelf"),_defineProperty(P,"alI","alignItems"),_defineProperty(P,"w","width"),_defineProperty(P,"h","height"),_defineProperty(P,"minH","minHeight"),_defineProperty(P,"maxH","maxHeight"),_defineProperty(P,"minW","minWidth"),_defineProperty(P,"maxW","maxWidth"),_defineProperty(P,"ftF","fontFamily"),_defineProperty(P,"ftSz","fontSize"),_defineProperty(P,"ftS","fontStyle"),_defineProperty(P,"ftWt","fontWeight"),_defineProperty(P,"lnH","lineHeight"),_defineProperty(P,"ltrS","letterSpacing"),_defineProperty(P,"txAl","textAlign"),_defineProperty(P,"txDc","textDecoration"),_defineProperty(P,"txDL","textDecorationLine"),P),A=r()?window:{devicePixelRatio:void 0,innerHeight:void 0,innerWidth:void 0,width:void 0,height:void 0,screen:{height:void 0,width:void 0}},setScreen=function(e){return{fontScale:1,height:e.screen.height,scale:e.devicePixelRatio||1,width:e.screen.width}},setWin=function(e){return{fontScale:1,height:e.innerHeight,scale:e.devicePixelRatio||1,width:e.innerWidth}},O={window:setWin(A),screen:setScreen(A)},T={},update=function(){O.window=setWin(A),O.screen=setScreen(A),o(T[w.CHANGE_EVENT])&&T[w.CHANGE_EVENT].forEach((function(e){return!e.shouldUnmount&&e(O)}))};r()&&t((function(){return e=window,r=w.RESIZE_EVENT,o=n(update,100),void(e&&t(e.addEventListener,r,o,i||!1));var e,r,o,i}));var Dimensions_get=function(e){return O[e]},Dimensions_addEventListener=function(e,r){e&&i(r)&&(T[e]=T[e]||[],T[e].push(r))},Dimensions_removeEventListener=function(e,r){e&&i(r)&&o(T[e])&&(T[e]=T[e].filter((function(e){return e!==r})))},E={},setDefaultTheme=function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return a(e)?E=r?f(E,e):e:console.warn("setDefaultTheme method requires an theme object as the first argument. Received: ",e)},getDefaultTheme=function(){return E},x=b.createContext(getDefaultTheme()),j={OS:"web",select:function(e){return a(e)&&e.web},Version:"ReTheme"},getDefaultPlatforms=function(){var e=d(j,"OS"),r=[];return"web"!==e&&r.push("$native"),r.push("$"+e),[w.PLATFORM.ALL].concat(r)},C={},addThemeEvent=function(e,r){if(e&&i(r))return C[e]=C[e]||[],C[e].push(r),C[e].length-1},removeThemeEvent=function(e,r){e&&C[e]&&(r||0===r)&&(u(r)?C[e].splice(r,1):i(r)&&o(C[e])&&(C[e]=C[e].filter((function(e){return e!==r}))))},fireThemeEvent=function(e){for(var r=arguments.length,t=new Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];o(C[e])&&C[e].forEach((function(e){return e.apply(void 0,t)}))},L={},getCurrentTheme=function(){return L},updateCurrentTheme=function(e){return L=e},R={entries:[["$xsmall",1],["$small",320],["$medium",768],["$large",1024],["$xlarge",1366]],hash:{},indexes:{}},buildSizeMapParts=function(){R.indexes=R.entries.reduce((function(e,r,t){return e[r[0]]=t,e[t]=r[0],R.hash[r[0]]=r[1],e}),{})},setSizes=function(e){return a(e)?(c(e,(function(r,t){var n=R.indexes[r];if(!s(n))return l("Invalid ".concat(r," for theme size! Allowed keys are xsmall | small | medium | large | xlarge"),"warn");var o=p(e[r]);if(!o||!R.entries[n])return l("Invalid size entry. Size must be a number and the size entry must exist!","Size: ".concat(o),"Entry: ".concat(R.entries[n]),"warn");R.entries[n]=[r,o]})),buildSizeMapParts(),R):l("setDimensions method requires an argument of type 'Object'.\nReceived: ",e,"error")},getSize=function(e){var r=u(e)&&e||p(e),t=R.entries.reduce((function(e,t){var n=_slicedToArray(t,2),o=n[0],i=n[1];return r>=i&&(e?i>R.hash[e]&&(e=o):e=o),e}),"$xsmall");return[t,R.hash[t]]},getMergeSizes=function(e){var r=Object.keys(R.hash),t=r.indexOf(e);return[r.slice(0,t+1),r.slice(t+1)]};buildSizeMapParts();var getSizeMap=function(){return R},useDimensions=function(){var e=_slicedToArray(_(Dimensions_get("window")),2),r=e[0],t=e[1],onChange=function(e){var r=e.window,n=r.width,o=r.height,i=r.scale,a=r.fontScale;t({width:n,height:o,scale:i,fontScale:a})};return m((function(){return Dimensions_addEventListener("change",onChange),function(){return onChange.shouldUnmount=!0,Dimensions_removeEventListener("change",onChange)}}),[]),r},W=w.PLATFORM,getTheme=function(){for(var e=getCurrentTheme(),r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];return f.apply(void 0,_toConsumableArray(t.reduce((function(r,t){var n=a(t)?t:y(t)||o(t)?d(e,t):null;return n&&r.push(n),r}),[])))},extract=function(e,r){if(!e[r])return e;var t=e[r];return delete e[r],f(e,t)},I=function compileStyles(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!a(e))return e;var t=r.platforms,n=r.sizes,o=r.omit,i=r.aliases,f=void 0===i?S:i,d=Object.entries(e).reduce((function(e,i){var d=_slicedToArray(i,2),u=d[0],l=d[1];if(t.includes(u)||n.includes(u))e[u]=_objectSpread2(_objectSpread2({},e[u]),compileStyles(l,r));else if(!o.includes(u)){var c=f[u]||u;e[c]=a(l)?_objectSpread2(_objectSpread2({},e[c]),compileStyles(l,r)):l}return e}),{}),u=t.reduce(extract,d),l=n.reduce(extract,u);return l},useCurrentSize=function(){var e=useDimensions(),r=_slicedToArray(g((function(){return getSize(e.width)}),[e.width]),2);return[r[0],r[1],e]},usePlatforms=function(){return g((function(){return e=getDefaultPlatforms(),r=Object.values(W).filter((function(r){return!e.includes(r)})),[e,r];var e,r}),[])},useCompiledStyles=function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=usePlatforms(),n=_slicedToArray(t,2),o=n[0],i=n[1],a=useCurrentSize(),f=_slicedToArray(a,3),d=f[0],u=f[1],l=f[2],c=l.width,s=l.height,p=g((function(){return getMergeSizes(d)||h}),[d]),y=_slicedToArray(p,2),b=y[0],_=y[1],m=g((function(){return i.concat(_)}),[i,_]),v=g((function(){return r?{key:d,size:u,width:c,height:s}:null}),[d,u,c,s]),P=g((function(){return I(e,{platforms:o,sizes:b,omit:m})}),[e,o,d]);return r&&(P.get=getTheme,P.RTMeta=v),P},useTheme=function(){return v(x)};export{w as C,x as R,_extends as _,updateCurrentTheme as a,_defineProperty as b,_slicedToArray as c,useTheme as d,_toConsumableArray as e,fireThemeEvent as f,getDefaultTheme as g,_objectSpread2 as h,getSize as i,getSizeMap as j,getMergeSizes as k,useDimensions as l,addThemeEvent as m,setDefaultTheme as n,_objectWithoutProperties as o,removeThemeEvent as r,setSizes as s,useCompiledStyles as u};
//# sourceMappingURL=useTheme-c9bf4c4a.js.map
